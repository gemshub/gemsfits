#########################################################################
#>>>>>>>>>>>>>>> GEMSFIT2 input file template >>>>>>>>>>>>>>>>>>>>>>>>>>#
#########################################################################
#  Character '#' means a comment line 

# MPI: Number of threads for parallelization

<MPI>  4

#########################################################################
#>>>>>>>>>>>>>>>>>>>>>> Data sources section >>>>>>>>>>>>>>>>>>>>>>>>>>>#
#########################################################################

# DataSource: get experimental data from the EJDB format database
#     (default:0, no other sources yet implemented in GEMSFIT2)

<DataSource>  0

# DataDB: EJDB database path (please, edit to put the actual path)

<DataDB>  './test_input/SOL/Si-Al-Na-K-Cl-OH-Pak2'

# DataCollection: database collection name (please, edit to put the actual name)

<DataCollection>  'experiments'

# DataSelect: query for obtaining the experimental data from the database.
# Options: 
#    '{ ... }': script in JSON format (in braces) describing what to select. 
#      "sample": [...]: list of comma-separated names of samples, 
#         or empty string "" to select all samples;
#      "expdataset": [...]: list of comma-separated names of experimental datasets, 
#         or empty string "" to select all available datasets;
#      "sT": [...]: list of comma-separated minimum and maximum temperature, C, 
#         or empty string "" to select data for all available temperatures; 
#      "sP": [...]: list of comma-separated minimum and maximum pressures, bar, 
#         or empty string "" to select data for all available pressures;  
#      Example: 
#      '{ "sample" : "", 
#        "expdataset" : ["CH04", "CH04D"],
#        "sT" : [100, 1000],
#        "sP" : [1, 2500] }'
#      Paste the above example below, remove comment symbols (#), and edit as necessary.

<DataSelect>
'{ "sample" : "", 
 "expdataset" : ["Walther&Orville1983", "Hemley_etal1980", "Manning1994", "Morey_etal1962", "Newton&Manning2001", "Shmulovich_etal2006", "Shmulovich_etal2001", "Anderson&Burnham1965",
 "Anderson&Burnham1967", "Novgorodov1975", "Novgorodov1977", "Wyart&Sabatier1955", "Morey&Hesselgesser1951", "Weill&Fyfe1964", "Kennedy1950", "Psat_Kennedy1950", "Psat_Morey_etal1962",     "Psat_Crear&Anderson1971", "Psat_Kitahara1960", "2_Morey&Hesselgesser1951", "Psat_Rimstidt1997", "Psat_Fournier1960", "Psat_vanLier1960", "Psat_Siever1962", "K_Anderson&Burnham1967", "K_Cloke1951", "Psat_NaOH_Crear&Anderson1971", "NaOH_Anderson&Burnham1967", "Psat_NaOH_Ostapenko1969", "NaCl_q_Novgorodov1977", "NaCl_q_Shmulovich_etal2006", "NaCl_q_Newton&Manning2001", "NaCl_q_Fournier_etal1982", "q_Fournier_etal1992", "NaCl_q_Anderson&Burnham1967", "Kcl_q_Anderson&Burnham1967", "Becker_etal1983", "Ragnarsdottir&Walther1985", "K_Pascal&Anderson1989", "Na_Pascal&Anderson1989", "K_Azaroual1996", "Gi_Na_Weselowski1992", "Gi_K_Weselowski1992", "Gi_Na_Russel_etal1955", "Gi_Na_Szita&Berecz1970", "Gi_Na_Apps_PhD1970", "Gi_Na_Tsirlina1936", "Gi_Na_Fricke&Jucaitis1930", "Gi_Na_Fulda&Ginsberg1951", "Gi_Na_Ikkatai&Okada1962", "Gi_Na_Lyapunov_etal1964"],
 "sT" : [1, 1000],
 "sP" : [0, 5000]
}'

# DataTarget: Target function for parameter fitting, described in JSON style
#     as text in single quotes and braces: '{ ... }' 
#  "Target":  name of the target (objective) function (optional)
#  "TT":  type of target function as sum of following terms: 
#     "lsq":       w*(measured-simulated)^2;
#     "lsq-norm":  w*(measured/avgm-simulated/avgm)^2;
#     ... 
#  "WT":  weighting scheme: empty string "": w = 1 (equal weights);
#       "inverr": w=1/error; "inverr2": w=1/error^2; "inverr3": w=1/measured^2;
#       "inverr_norm": w=1/(error/<meas(average)>)^2; 
#  "OFUN":  objective function, a list [] of terms {} for measured properties to compare with their computed counterparts. 
#     Each term can contain property-value pairs:
#       "EPH": for what phase from the experiments 
#       "EN":  for what element from the phase 
#       "EP":  for what property of the phase
#       "Eunit":  what unit the values should are given in (overrides the units given in the database for this entry):
#          "molal":  mol/(kg H2O), "loga": log(molal), "-loga": negated log(molal);
#          "g"; "kg"; "cm3"; "m3"; "molfrac": mole fraction 
#           ...
#       "DCPH":  phase to which the dependent component belongs
#       "DC":  dependent component
#       "DCP":  dependent component property
#       "DCPunit":  property unit - overrides the units given in the database for this entry
#       (conversions are performed automatically.)
#     The compare options are: 
#       aqueous phase ("aq_gen") elemental composition in "molal" or "loga" 
#       aqueous phase ("aq_gen") properties ("EP"): "pH" in "-loga" (or "molal" - molality concentration of H+); "pQnt" - mass in "g" or "kg"  
#       other phases composition as element bulk phase concentration in moles ("mol") or to /Si molar ratio ("Simolfrac")
#       other phases properties ("EP"): "pQnt" - mass in "g" or "kg"; "pV" - volume in "cm3" or "m3" 
#       dependent components ("DC") properties: "pQnt" - amount in "molfrac"; "@coef" - activity coefictient 
#  Example:
#  '{ "Target": "name", "TT": "lsq", "WT": "inverr", "OFUN":
#      [
#         { "EPH": "aq_gen", "EN": "Si", "Eunit": "molal" },
#         { "EPH": "aq_gen", "EN": "Al", "Eunit": "molal" },
#         { "EPH": "aq_gen", "EP": "pH", "Eunit": "-loga" },
#         { "DCPH": "aq_gen", "DC": "SiO2-", "DCP" : "pQnt", "DCPunit": "mol"}
#      ]
#   }'
#  Paste the above example below, remove comment symbols (#), and edit as necessary.

<DataTarget>
'{ "Target": "name", "TT": "lsq", "WT": "inverr3", "OFUN": 
  [ 
    { "EPH": "aq_gen", "EN": "Al",  "Eunit": "molal", "Eerr": "log_error" },
    { "EPH": "aq_gen", "EN": "Si",  "Eunit": "molal", "Eerr": "log_error" },
    { "EPH": "aq_gen", "EN": "K",   "Eunit": "molal", "Eerr": "log_error" },
    { "EPH": "aq_gen", "EN": "Na",  "Eunit": "molal", "Eerr": "log_error" },
    { "EPH": "aq_gen", "EN": "Cl",  "Eunit": "molal", "Eerr": "log_error" }
  ]
}'

# SystemFiles: path to the list of GEMS3K input files (also used for this template file)

<SystemFiles>  './test_input/Si-Al-Na-K-Cl-OH-Pak-dat.lst'

# LimitOfDetection: Limit of detection of the measured values.
# Ensures that wrongly computed values calculated by GEMS due to non-physical parameter values are ignored.

<LimitOfDetection>  1e-07

#########################################################################
#>>>>>>>>>>>>>>> Parameters to Fit section >>>>>>>>>>>>>>>>>>>>>>>>>>>>>#
#########################################################################

#  GEM input parameters to be fitted can be marked by preceding them with the F, L, and R letter 
#    in <TKval>, <Pval>, <G0>,  <PMc>, <DMc>, <fDQF>, <bIC> ... data object entries below.
#  Mark with F the parameter value you want to fit independently of other parameters. Options:
#    F-833444.00006792 : the initial value with default (10%) upper- and lower boundaries;
#    or as in this example for fitting G0(298) of SiO2@ : 
#      F{ "IV" :-833444.00006792, "UB" : -800000, "LB" : -900000 }    where:
#      "IV": initial value; 
#      "UB": upper boundary; 
#      "LB": lower bundary (in this case, all in J/mol). 
#  Mark with R the G0(298) value of a dependent component, which depends on G0 of other dependent components
#     via a reaction constraint, by copy-pasting the following template in place of the G0(298) value,
#     and edit it to make the desired changes:
#      R{ "IV" : -36819, "Ref" : "SUPCRT92", "logK" : -14.46, "nC" : 4, "dcomp" : "KOH@",
#      "RC" : [ "K+", "H2O@", "H+", "KOH@" ], "Rcoef" : [ -1, -1, 1, 1 ] }
#     Here,  "IV": initial value; 
#          "Ref": bibliographic reference;
#         "logK": reaction equilibrium constant at 298 K, 1 bar; 
#         "nC": numer of components (species) involved in the reaction;
#         "dcomp": name of dependent component whose properties are constrained with this reaction; 
#         "RC": list [ ] of names of all components (species) involved in the reaction (comma-separated);
#         "Rcoef": array [ ] of reaction stoichiometry coeficients (comma-separated), in the same order as in the "RC" list.
#  Mark with L the bIC (element bulk composition) value of an independent component, which depends on bIC of other elements
#     via a titration constraint by copy-pasting the following template in place of the bIC value,
#     and edit it to make the desired changes:
#      L{ "LE" :"H", "IV" :113.016746705914, "LEs" :["S", "Cl"], "Lcoef" :[2,1]}
#     Here, H is linked to S and Cl by titration of H2SO4 and HCl, with the stoechiometric coeficients of 2 and 1, respectively.
#         "LE": linked element 
#         "IV": initial value 
#         "LEs": the elements linked to 
#         "Lcoef": linking coeficients (stoechiometric coeficients) 

# ICNL: List of Independent Component names (for readability)
<ICNL>
'Al' 'Cl' 'H' 'K' 'Na' 'Nit' 'O' 'Si' 'Zz' 
# DCNL: List of Dependent Component names (for readability)
<DCNL>
'Al(OH)2+' 'Al(OH)3@' 'Al(OH)4-' 'Al+3' 'AlH3SiO4+2' 'AlO+' 'AlO2-' 'AlO2H@' 'AlOH+2' 'K+' 'KAlO2@' 'KCl@' 'KOH@' 'Na+' 'NaAl(OH)4@' 'NaAlO2@' 'NaCl@' 'NaHSiO3@' 'NaOH@' 'HSiO3-' 'SiO2@' 'ClO-' 'HClO@' 'ClO2-' 'HClO2@' 'ClO3-' 'ClO4-' 'Cl-' 'HCl@' 'H2@' 'N2@' 'O2@' 'H2O2@' 'HO2-' 'OH-' 'H+' 'H2O@' 'H2' 'N2' 'O2' 
'Albite' 'Albite high' 'Analcite' 'Andalusite' 'Bhm' 'Coesite' 'Corundum' 'Cristobalite' 'Gbs2' 'Halite' 'Jadeite' 'Kalsilite' 'Kaolinite' 'Kyanite' 'Leucite' 'Microcline' 'Muscovite' 'Nepheline' 'Paragonite' 'Pyrophyllite' 'Quartz' 'Sanidine' 'Sillimanite' 'Stishovite' 'Sylvite' 'Topaz-OH' 'Tridymite' 
# PHNL: List of Phase names (for readability)
<PHNL>
'aq_gen' 'gas_gen' 'Albite' 'Albite high' 'Analcite' 'Andalusite' 'Boehmite' 'Coesite' 'Corundum' 'Cristobalite' 'Gibbsite' 'Halite' 'Jadeite' 'Kalsilite' 'Kaolinite' 'Kyanite' 'Leucite' 'Microcline' 'Muscovite' 'Nepheline' 'Paragonite' 'Pyrophyllite' 'Quartz' 'Sanidine' 'Sillimanite' 'Stishovite' 'Sylvite' 'Topaz-OH' 'Tridymite' 
# ccPH: Codes of phase aggregate state [nPH]
<ccPH>
'a' 'g' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 's' 
# nDCinPH: Number of DCs included in each phase [nPH]
<nDCinPH>
37 3 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 
# TKval: Temperature values, K for lookup arrays of thermodynamic data [nTp]
<TKval>
298.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 
373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 
373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 
373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 
373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 
373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 
373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 
373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 
373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 
373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 
373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 
373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 373.15 
# Pval: Pressure values, Pa for lookup arrays of thermodynamic data [nPp]
<Pval>
100000 -1.24404596840027e+268 -2.48809193680053e+268 -3.7321379052008e+268 -4.97618387360106e+268 -6.22022984200133e+268 -7.46427581040159e+268 -8.70832177880186e+268 -9.95236774720213e+268 -1.11964137156024e+269 -1.24404596840027e+269 -1.36845056524029e+269 -1.49285516208032e+269 -1.61725975892035e+269 -1.74166435576037e+269 -1.8660689526004e+269 -1.99047354944043e+269 -2.11487814628045e+269 -2.23928274312048e+269 -2.3636873399605e+269 -2.48809193680053e+269 -2.61249653364056e+269 -2.73690113048058e+269 -2.86130572732061e+269 -2.98571032416064e+269 -3.11011492100066e+269 -3.23451951784069e+269 -3.35892411468072e+269 -3.48332871152074e+269 -3.60773330836077e+269 -3.7321379052008e+269 -3.85654250204082e+269 -3.98094709888085e+269 -4.10535169572088e+269 -4.2297562925609e+269 -4.35416088940093e+269 -4.47856548624096e+269 -4.60297008308098e+269 -4.72737467992101e+269 -4.85177927676104e+269 
-4.97618387360106e+269 -5.10058847044109e+269 -5.22499306728112e+269 -5.34939766412114e+269 -5.47380226096117e+269 -5.5982068578012e+269 -5.72261145464122e+269 -5.84701605148125e+269 -5.97142064832128e+269 -6.0958252451613e+269 -6.22022984200133e+269 -6.34463443884135e+269 -6.46903903568138e+269 -6.59344363252141e+269 -6.71784822936143e+269 -6.84225282620146e+269 -6.96665742304149e+269 -7.09106201988151e+269 -7.21546661672154e+269 -7.33987121356157e+269 -7.46427581040159e+269 -7.58868040724162e+269 -7.71308500408165e+269 -7.83748960092167e+269 -7.9618941977617e+269 -8.08629879460173e+269 -8.21070339144175e+269 -8.33510798828178e+269 -8.45951258512181e+269 -8.58391718196183e+269 -8.70832177880186e+269 -8.83272637564189e+269 -8.95713097248191e+269 -9.08153556932194e+269 -9.20594016616196e+269 -9.33034476300199e+269 -9.45474935984202e+269 -9.57915395668204e+269 -9.70355855352207e+269 -9.8279631503621e+269 
-9.95236774720212e+269 -1.00767723440422e+270 -1.02011769408822e+270 -1.03255815377222e+270 -1.04499861345622e+270 -1.05743907314023e+270 -1.06987953282423e+270 -1.08231999250823e+270 -1.09476045219223e+270 -1.10720091187624e+270 -1.11964137156024e+270 -1.13208183124424e+270 -1.14452229092824e+270 -1.15696275061225e+270 -1.16940321029625e+270 -1.18184366998025e+270 -1.19428412966426e+270 -1.20672458934826e+270 -1.21916504903226e+270 -1.23160550871626e+270 -1.24404596840027e+270 -1.25648642808427e+270 -1.26892688776827e+270 -1.28136734745227e+270 -1.29380780713628e+270 -1.30624826682028e+270 -1.31868872650428e+270 -1.33112918618828e+270 -1.34356964587229e+270 -1.35601010555629e+270 -1.36845056524029e+270 -1.38089102492429e+270 -1.3933314846083e+270 -1.4057719442923e+270 -1.4182124039763e+270 -1.43065286366031e+270 -1.44309332334431e+270 -1.45553378302831e+270 -1.46797424271231e+270 -1.48041470239632e+270 
-1.49285516208032e+270 -1.50529562176432e+270 -1.51773608144832e+270 -1.53017654113233e+270 -1.54261700081633e+270 -1.55505746050033e+270 -1.56749792018433e+270 -1.57993837986834e+270 -1.59237883955234e+270 -1.60481929923634e+270 -1.61725975892035e+270 -1.62970021860435e+270 -1.64214067828835e+270 -1.65458113797235e+270 -1.66702159765636e+270 -1.67946205734036e+270 -1.69190251702436e+270 -1.70434297670836e+270 -1.71678343639237e+270 -1.72922389607637e+270 -1.74166435576037e+270 -1.75410481544437e+270 -1.76654527512838e+270 -1.77898573481238e+270 -1.79142619449638e+270 -1.80386665418039e+270 -1.81630711386439e+270 -1.82874757354839e+270 -1.84118803323239e+270 -1.8536284929164e+270 -1.8660689526004e+270 -1.8785094122844e+270 -1.8909498719684e+270 -1.90339033165241e+270 -1.91583079133641e+270 -1.92827125102041e+270 -1.94071171070441e+270 -1.95315217038842e+270 -1.96559263007242e+270 -1.97803308975642e+270 
-1.99047354944042e+270 -2.00291400912443e+270 -2.01535446880843e+270 -2.02779492849243e+270 -2.04023538817644e+270 -2.05267584786044e+270 -2.06511630754444e+270 -2.07755676722844e+270 -2.08999722691245e+270 -2.10243768659645e+270 -2.11487814628045e+270 -2.12731860596445e+270 -2.13975906564846e+270 -2.15219952533246e+270 -2.16463998501646e+270 -2.17708044470046e+270 -2.18952090438447e+270 -2.20196136406847e+270 -2.21440182375247e+270 -2.22684228343648e+270 -2.23928274312048e+270 -2.25172320280448e+270 -2.26416366248848e+270 -2.27660412217249e+270 -2.28904458185649e+270 -2.30148504154049e+270 -2.31392550122449e+270 -2.3263659609085e+270 -2.3388064205925e+270 -2.3512468802765e+270 -2.3636873399605e+270 -2.37612779964451e+270 -2.38856825932851e+270 -2.40100871901251e+270 -2.41344917869652e+270 -2.42588963838052e+270 -2.43833009806452e+270 -2.45077055774852e+270 -2.46321101743253e+270 -2.47565147711653e+270 
-2.48809193680053e+270 -2.50053239648453e+270 -2.51297285616854e+270 -2.52541331585254e+270 -2.53785377553654e+270 -2.55029423522054e+270 -2.56273469490455e+270 -2.57517515458855e+270 -2.58761561427255e+270 -2.60005607395656e+270 -2.61249653364056e+270 -2.62493699332456e+270 -2.63737745300856e+270 -2.64981791269257e+270 -2.66225837237657e+270 -2.67469883206057e+270 -2.68713929174457e+270 -2.69957975142858e+270 -2.71202021111258e+270 -2.72446067079658e+270 -2.73690113048058e+270 -2.74934159016459e+270 -2.76178204984859e+270 -2.77422250953259e+270 -2.78666296921659e+270 -2.7991034289006e+270 -2.8115438885846e+270 -2.8239843482686e+270 -2.83642480795261e+270 -2.84886526763661e+270 -2.86130572732061e+270 -2.87374618700461e+270 -2.88618664668862e+270 -2.89862710637262e+270 -2.91106756605662e+270 -2.92350802574062e+270 -2.93594848542463e+270 -2.94838894510863e+270 -2.96082940479263e+270 -2.97326986447663e+270 
-2.98571032416064e+270 -2.99815078384464e+270 -3.01059124352864e+270 -3.02303170321265e+270 -3.03547216289665e+270 -3.04791262258065e+270 -3.06035308226465e+270 -3.07279354194866e+270 -3.08523400163266e+270 -3.09767446131666e+270 -3.11011492100066e+270 -3.12255538068467e+270 -3.13499584036867e+270 -3.14743630005267e+270 -3.15987675973667e+270 -3.17231721942068e+270 -3.18475767910468e+270 -3.19719813878868e+270 -3.20963859847269e+270 -3.22207905815669e+270 -3.23451951784069e+270 -3.24695997752469e+270 -3.2594004372087e+270 -3.2718408968927e+270 -3.2842813565767e+270 -3.2967218162607e+270 -3.30916227594471e+270 -3.32160273562871e+270 -3.33404319531271e+270 -3.34648365499671e+270 -3.35892411468072e+270 -3.37136457436472e+270 -3.38380503404872e+270 -3.39624549373273e+270 -3.40868595341673e+270 -3.42112641310073e+270 -3.43356687278473e+270 -3.44600733246874e+270 -3.45844779215274e+270 -3.47088825183674e+270 
-3.48332871152074e+270 -3.49576917120475e+270 -3.50820963088875e+270 -3.52065009057275e+270 -3.53309055025675e+270 -3.54553100994076e+270 -3.55797146962476e+270 -3.57041192930876e+270 -3.58285238899277e+270 -3.59529284867677e+270 -3.60773330836077e+270 -3.62017376804477e+270 -3.63261422772878e+270 -3.64505468741278e+270 -3.65749514709678e+270 -3.66993560678078e+270 -3.68237606646479e+270 -3.69481652614879e+270 -3.70725698583279e+270 -3.71969744551679e+270 -3.7321379052008e+270 -3.7445783648848e+270 -3.7570188245688e+270 -3.76945928425281e+270 -3.78189974393681e+270 -3.79434020362081e+270 -3.80678066330481e+270 -3.81922112298882e+270 -3.83166158267282e+270 -3.84410204235682e+270 -3.85654250204082e+270 -3.86898296172483e+270 -3.88142342140883e+270 -3.89386388109283e+270 -3.90630434077683e+270 -3.91874480046084e+270 -3.93118526014484e+270 -3.94362571982884e+270 -3.95606617951284e+270 -3.96850663919685e+270 
-3.98094709888085e+270 -3.99338755856485e+270 -4.00582801824886e+270 -4.01826847793286e+270 -4.03070893761686e+270 -4.04314939730086e+270 -4.05558985698487e+270 -4.06803031666887e+270 -4.08047077635287e+270 -4.09291123603687e+270 -4.10535169572088e+270 -4.11779215540488e+270 -4.13023261508888e+270 -4.14267307477288e+270 -4.15511353445689e+270 -4.16755399414089e+270 -4.17999445382489e+270 -4.1924349135089e+270 -4.2048753731929e+270 -4.2173158328769e+270 -4.2297562925609e+270 -4.24219675224491e+270 -4.25463721192891e+270 -4.26707767161291e+270 -4.27951813129691e+270 -4.29195859098092e+270 -4.30439905066492e+270 -4.31683951034892e+270 -4.32927997003292e+270 -4.34172042971693e+270 -4.35416088940093e+270 -4.36660134908493e+270 -4.37904180876894e+270 -4.39148226845294e+270 -4.40392272813694e+270 -4.41636318782094e+270 -4.42880364750495e+270 -4.44124410718895e+270 -4.45368456687295e+270 -4.46612502655695e+270 
-4.47856548624096e+270 -4.49100594592496e+270 -4.50344640560896e+270 -4.51588686529296e+270 -4.52832732497697e+270 -4.54076778466097e+270 -4.55320824434497e+270 -4.56564870402897e+270 -4.57808916371298e+270 -4.59052962339698e+270 -4.60297008308098e+270 -4.61541054276499e+270 -4.62785100244899e+270 -4.64029146213299e+270 -4.65273192181699e+270 -4.665172381501e+270 -4.677612841185e+270 -4.690053300869e+270 -4.702493760553e+270 -4.71493422023701e+270 -4.72737467992101e+270 -4.73981513960501e+270 -4.75225559928902e+270 -4.76469605897302e+270 -4.77713651865702e+270 -4.78957697834102e+270 -4.80201743802502e+270 -4.81445789770903e+270 -4.82689835739303e+270 -4.83933881707703e+270 -4.85177927676104e+270 -4.86421973644504e+270 -4.87666019612904e+270 -4.88910065581304e+270 -4.90154111549705e+270 -4.91398157518105e+270 -4.92642203486505e+270 -4.93886249454905e+270 -4.95130295423306e+270 -4.96374341391706e+270 
-4.97618387360106e+270 -4.98862433328507e+270 -5.00106479296907e+270 -5.01350525265307e+270 -5.02594571233707e+270 -5.03838617202108e+270 -5.05082663170508e+270 -5.06326709138908e+270 -5.07570755107308e+270 -5.08814801075709e+270 -5.10058847044109e+270 -5.11302893012509e+270 -5.1254693898091e+270 -5.1379098494931e+270 -5.1503503091771e+270 -5.1627907688611e+270 -5.1752312285451e+270 -5.18767168822911e+270 -5.20011214791311e+270 -5.21255260759711e+270 -5.22499306728112e+270 -5.23743352696512e+270 -5.24987398664912e+270 -5.26231444633312e+270 -5.27475490601713e+270 -5.28719536570113e+270 -5.29963582538513e+270 -5.31207628506913e+270 -5.32451674475314e+270 -5.33695720443714e+270 -5.34939766412114e+270 -5.36183812380515e+270 -5.37427858348915e+270 -5.38671904317315e+270 -5.39915950285715e+270 -5.41159996254116e+270 -5.42404042222516e+270 -5.43648088190916e+270 -5.44892134159316e+270 -5.46136180127717e+270 
-5.47380226096117e+270 -5.48624272064517e+270 -5.49868318032917e+270 -5.51112364001318e+270 -5.52356409969718e+270 -5.53600455938118e+270 -5.54844501906518e+270 -5.56088547874919e+270 -5.57332593843319e+270 -5.58576639811719e+270 -5.5982068578012e+270 -5.6106473174852e+270 -5.6230877771692e+270 -5.6355282368532e+270 -5.64796869653721e+270 -5.66040915622121e+270 -5.67284961590521e+270 -5.68529007558921e+270 -5.69773053527322e+270 -5.71017099495722e+270 -5.72261145464122e+270 -5.73505191432522e+270 -5.74749237400923e+270 -5.75993283369323e+270 -5.77237329337723e+270 -5.78481375306124e+270 -5.79725421274524e+270 -5.80969467242924e+270 -5.82213513211324e+270 -5.83457559179725e+270 -5.84701605148125e+270 -5.85945651116525e+270 -5.87189697084925e+270 
 
# G0: Look-up array for DC molar Gibbs energy function g(T,P), J/mol at 298.15K and 1 bar 
<G0>
-899506.00028008
-1101735
F{"IV": -1305814.0005473, "LB": -1350000, "UB" : -1250000 }
-487478.00144161
-1781798.0004629
-661859.00050346
F{"IV": -831332.00091632, "LB": -860000 , "UB" : -800000 }
-869016.99998422
-696322.0008363
F-282462.00010137
-1106169.9999737
-399278.99998001
F-437227.99998422
F-261881.00017392
-1567372
F{"IV": -1088998.9999474, "LB": -1130000 , "UB" : -1040000 }
F-388734.99998001
-1288211.99998
F-417981.99998422
F{ "IV" :-1015879.000816, "UB" : -1000000, "LB" : -1100000 }
F{ "IV" :-833411.00006792, "UB" : -800000, "LB" : -900000 }
-36819.000776856
-79913.999908779
17153.999335198
5858.0001796547
-7950.0005480658
-8535.0005102409
F-131290.00076597
-127240
17723.00010995
18188.000182443
16544.000207432
-134013.99990483
-67321.000812735
F-157297.00090727
0
-237181.38483664
0
0
0
-3711995.9765072
-3706202
-3091093
-2441050
-908974
-850864
-1581808
-853084
-1169830
-384246
-2849218
-2006218
-3801669
-2442617
-2866365.9094819
-3750316
-5603884
-1980504.9942027
-5565263
-5266775
-856432.97934399
-3744340
-2438764.9906227
-816165
-408587
-2690013
-853665


#########################################################################
#>>>>>>>>>> Input for fitting non-ideality parameters >>>>>>>>>>>>>>>>>>#
#########################################################################

# Initial data for multicomponent phases (fragment of GEMS3K *IMP.dat input file)
#    (see DCH file for dimension nPHs)
# sMod: Codes for TSolMod built-in  models of mixing in multicomponent phases [nPS*6]
<sMod>
'HNNSNN' 'INNINN' 

# LsMod: Dimensions of TSolMod <IPxPH> and <PMc> data arrays [nPS*3]. In each row (for phase):
# [0] number of interaction parameters (rows in <IPx>); [1] max. parameter order (columns in <IPx>);
# [2] number of coefficients per interaction parameter in <PMc> array
<LsMod>
2 0 4 
0 0 0 

# PMc: Tables (in TSolMod convention) of interaction parameter coefficients  for non-ideal solutions
<PMc>
0.0640000030398369 3.72000002861023 1 1 1 0 0 0 

# LsMdc: Dimensions of TSolMod <DMc> and <MoiSN> arrays [nPS*3]: In each row (for phase):
# [0] number of parameters per component; [1] 0; [2] 0. For multi-site (sublattice) models: 
#   [1] number of sublattices nS; [2] total number of moieties nM acting in sublattice sites
<LsMdc>
0 0 0 
0 0 0 

# fDQF: DQF parameters of end members or pure gas fugacities, (J/mol/(RT) [nDC]
<fDQF>
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 

# This part for the system composition data is taken from *DBR.dat

# For fitting T and P parameters in thermobarometry application give the upper and lower values correspodning 
# to the interpolation range you selected when the GEMS3K system files were exported 
# TK: Node temperature T, Kelvin. This value must always be provided (GEM input)
<TK>  373.15
# P:  Node Pressure P, Pa. This value must always be provided (GEM input)
<P>  101322

## (4) Data for Independent Components
#  'Al' 'Cl' 'H' 'K' 'Na' 'Nit' 'O' 'Si' 'Zz' 
# bIC: Bulk composition of reactive subsystem (main GEM input), moles of ICs [nICb]
<bIC>
6.40996460178633 1e-09 133.376188475639 1e-09 3.12954801263371 1e-09 77.8678151468158 1e-09 0 

## (5) Data for Dependent Components
#  'Al(OH)2+' 'Al(OH)3@' 'Al(OH)4-' 'Al+3' 'AlH3SiO4+2' 'AlO+' 'AlO2-' 'AlO2H@' 'AlOH+2' 'K+' 'KAlO2@' 'KCl@' 'KOH@' 'Na+' 'NaAl(OH)4@' 'NaAlO2@' 'NaCl@' 'NaHSiO3@' 'NaOH@' 'HSiO3-' 'SiO2@' 'ClO-' 'HClO@' 'ClO2-' 'HClO2@' 'ClO3-' 'ClO4-' 'Cl-' 'HCl@' 'H2@' 'N2@' 'O2@' 'H2O2@' 'HO2-' 'OH-' 'H+' 'H2O@' 'H2' 'N2' 'O2' 
#  'Albite' 'Albite high' 'Analcite' 'Andalusite' 'Bhm' 'Coesite' 'Corundum' 'Cristobalite' 'Gbs2' 'Halite' 'Jadeite' 'Kalsilite' 'Kaolinite' 'Kyanite' 'Leucite' 'Microcline' 'Muscovite' 'Nepheline' 'Paragonite' 'Pyrophyllite' 'Quartz' 'Sanidine' 'Sillimanite' 'Stishovite' 'Sylvite' 'Topaz-OH' 'Tridymite' 
# xDC: Speciation - amounts of DCs in equilibrium (primal solution), moles (GEM output/input) [nDCb]
<xDC>
6.95724303239906e-18 1.5904821238001e-10 0.00912997663660231 2.40592605812113e-33 0 3.79560555568937e-18 0.0119165673561446 9.51708424739542e-10 1.70945158746087e-25 6.5175981071966e-10 1.74384986800316e-12 3.42682628011863e-21 3.4649633940891e-10 2.02834933719689 0.0164936345925304 0.00520129794747366 1.93273540485037e-10 9.21345906440367e-10 1.07950374178225 7.86401288851277e-11 1.39646745050429e-14 0 0 0 0 0 0 8.06726459511514e-10 2.21893483913058e-23 1.8631332926347e-09 5e-10 0 0 0 2.00730279297093 5.00332634057073e-13 55.5426090583477 0 0 0 
0 0 0 0 0 0 0 0 6.36722312414278 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 

# dll: Lower metastability restrictions on amounts of DCs, moles (GEM input) [nDCb]
<dll>
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 

# dul: Upper metastability constraints on amounts of DCs, moles (GEM input) [nDCb]
<dul>
1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 
1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 1000000 

## (6) Data for Phases
#  'aq_gen' 'gas_gen' 'Albite' 'Albite high' 'Analcite' 'Andalusite' 'Boehmite' 'Coesite' 'Corundum' 'Cristobalite' 'Gibbsite' 'Halite' 'Jadeite' 'Kalsilite' 'Kaolinite' 'Kyanite' 'Leucite' 'Microcline' 'Muscovite' 'Nepheline' 'Paragonite' 'Pyrophyllite' 'Quartz' 'Sanidine' 'Sillimanite' 'Stishovite' 'Sylvite' 'Topaz-OH' 'Tridymite' 
# aPH: Specific surface areas of phases, m2/kg (GEM input) [nPHb]
<aPH>
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
# Vs: Volume V of reactive subsystem, m3 (GEM output)
<Vs>  0.00124411
# Ms: Mass of reactive subsystem, kg (GEM output)
<Ms>  1.62517
# Gs: Total Gibbs energy of the reactive subsystem, J/(RT) (GEM output)
<Gs>  -7207.93
# IS: Effective aqueous ionic strength, molal (GEM output)
<IS>  2.0271
# pH: pH of aqueous solution in molal activity scale (GEM output)
<pH>  12.4518
# pe: pe of aqueous solution in molal activity scale (GEM output)
<pe>  -9.00817
# Eh: Eh of aqueous solution, V (GEM output)
<Eh>  -0.665632

## (4) Data for Independent Components
#  'Al' 'Cl' 'H' 'K' 'Na' 'Nit' 'O' 'Si' 'Zz' 

# uIC: Chemical potentials of ICs in equilibrium (dual solution), J/(RT) (GEM output) [nICb]
<uIC>
-167.440512730964 -85.4059838479049 -7.92916785674542 -94.2789714422651 -64.849286210787 -9.05204201578271 -62.5948998977784 -176.383343539655 -20.74207037974 

# bSP: Output bulk composition of the equilibrium solid part of the system, moles 
<bSP>
6.36722312414278 0 19.1016693724283 0 0 0 19.1016693724283 0 0 

## (5) Data for Dependent Components
#  'Al(OH)2+' 'Al(OH)3@' 'Al(OH)4-' 'Al+3' 'AlH3SiO4+2' 'AlO+' 'AlO2-' 'AlO2H@' 'AlOH+2' 'K+' 'KAlO2@' 'KCl@' 'KOH@' 'Na+' 'NaAl(OH)4@' 'NaAlO2@' 'NaCl@' 'NaHSiO3@' 'NaOH@' 'HSiO3-' 'SiO2@' 'ClO-' 'HClO@' 'ClO2-' 'HClO2@' 'ClO3-' 'ClO4-' 'Cl-' 'HCl@' 'H2@' 'N2@' 'O2@' 'H2O2@' 'HO2-' 'OH-' 'H+' 'H2O@' 'H2' 'N2' 'O2' 
#  'Albite' 'Albite high' 'Analcite' 'Andalusite' 'Bhm' 'Coesite' 'Corundum' 'Cristobalite' 'Gbs2' 'Halite' 'Jadeite' 'Kalsilite' 'Kaolinite' 'Kyanite' 'Leucite' 'Microcline' 'Muscovite' 'Nepheline' 'Paragonite' 'Pyrophyllite' 'Quartz' 'Sanidine' 'Sillimanite' 'Stishovite' 'Sylvite' 'Topaz-OH' 'Tridymite' 

# gam: Activity coefficients of DCs in their respective phases (GEM output/input) [nDCb]
<gam>
0.706721228037877 1.4216468208891 0.706721228037877 0.00263572128342452 0.0868195222494123 0.706721228037877 0.706721228037877 1.4216468208891 0.0868195222494123 0.706721228037877 1.4216468208891 1.4216468208891 1.4216468208891 0.706721228037877 1.4216468208891 1.4216468208891 1.4216468208891 1.4216468208891 1.4216468208891 0.706721228037877 1.4216468208891 0.706721228037877 1.4216468208891 0.706721228037877 1.4216468208891 0.706721228037877 0.706721228037877 0.706721228037877 1.4216468208891 1.4216468208891 1.4216468208891 1.4216468208891 1.4216468208891 0.706721228037877 0.706721228037877 0.706721228037877 0.985083968501089 1 1 1 
1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 

## (6) Data for Phases
#  'aq_gen' 'gas_gen' 'Albite' 'Albite high' 'Analcite' 'Andalusite' 'Boehmite' 'Coesite' 'Corundum' 'Cristobalite' 'Gibbsite' 'Halite' 'Jadeite' 'Kalsilite' 'Kaolinite' 'Kyanite' 'Leucite' 'Microcline' 'Muscovite' 'Nepheline' 'Paragonite' 'Pyrophyllite' 'Quartz' 'Sanidine' 'Sillimanite' 'Stishovite' 'Sylvite' 'Topaz-OH' 'Tridymite' 

# xPH: Amounts of phases in equilibrium state, moles (GEM output) [nPHb]
<xPH>
60.7005064133049 0 0 0 0 0 0 0 0 0 6.36722312414278 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 

# vPS: Volumes of multicomponent phases, m3 (GEM output) [nPSb]
<vPS>
0.00104064199940379 0 

# mPS: Masses of multicomponent phases, kg (GEM output) [nPSb]
<mPS>
1.12850698714219 0 

# xPA: Amount of carrier (sorbent or solvent) in multicomponent phases, moles (GEM output) [nPSb]
<xPA>
55.5426090583477 0 

# bPS: Bulk elemental compositions of multicomponent phases, moles (GEM output) [nPSb*nICb]
#  'Al' 'Cl' 'H' 'K' 'Na' 'Nit' 'O' 'Si' 'Zz' 
<bPS>
0.0427414776452515 9.99999999996551e-10 114.274519102867 9.99999999996573e-10 3.12954801263376 1e-09 58.7661457743552 1e-09 9.99063284646307e-14 
0 0 0 0 0 0 0 0 0 

#########################################################################
#>>>>>>>>>>>>>>> Optimization Methods section >>>>>>>>>>>>>>>>>>>>>>>>>>>>>#
#########################################################################


# OptDoWhat: perform optimization and statistics (0), only optimization with basic Statistics (1), only Statistics (2) with initial guesses as best fit parametters
<OptDoWhat>  0

# OptAlgo: specify algorithm GN_ISRES GN_ORIG_DIRECT GN_ORIG_DIRECT_L LN_COBYLA LN_BOBYQA 
<OptAlgo>  'LN_BOBYQA'

# OptBoundPerc: Generate bounds from initial guess vector: specify percentage deviation (user specific, user-defined bounds when set to -1)
<OptBoundPerc>  -1

# OptTolRel: stopping criterion -> specify relative tolerance (default = 1e-04) of function value
<OptTolRel>  1e-06

# OptTolAbs: stopping criterion -> specify absolute tolerance (default = 1e-04) of function value
<OptTolAbs>  1e-06

# OptMaxEval: specify max number of evaluations
<OptMaxEval>  500000

# OptInitStep: specify initial stepsize for local minimizers (factor will be multiplied to all optimization parameters); 0 => use default
<OptInitStep>  0

# OptNormParam: Normalize bounds/constraints/fitting parameters with initial guess vector
<OptNormParam>  1

# OptPerturbator: The delta/difference used to to calculate the d(function_value)/d(parameter_value) gradient
<OptPerturbator>  0.001

# StatMCruns: number of Monte Carlo runs for confidence interval generation
<StatMCruns>  10

# StatSensitivity: number of evaluations points per parameter for sensitivity evaluation
<StatSensitivity>  50

# StatMCbool: perform Monte Carlo runs -> yes (1)/no (0)
<StatMCbool>  0

# StatPerturbator: used for calculating sensitivities by central diference, see ref [2]
<StatPerturbator>  0.0001
